#!/bin/sh
emacs -q -eval "(add-to-list 'load-path (expand-file-name \"~/.emacs.d/lisp\"))(require 'media)(emms-history-load)(unless (fboundp 'remove-if) (require 'cl))(let ((buf (car (remove-if '(lambda (x) (= (buffer-size x) 0)) (emms-playlist-buffer-list)))))(if (null buf) (emms) (switch-to-buffer buf)))(add-hook 'emms-player-started-hook '(lambda () (set-process-query-on-exit-flag (get-process \"emms-player-simple-process\") nil)))" $*
# first require 'MEDIA (and a minimalist configuration)
# then restore the last session with 'EMMS-HISTORY-LOAD
# finally go to the last playlist or open a new one
